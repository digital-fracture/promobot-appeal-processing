
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="KruASe">
      
      
      
        <link rel="prev" href="..">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.25">
    
    
      
        <title>API reference - Promobot Appeal Processing</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Promobot Appeal Processing" class="md-header__button md-logo" aria-label="Promobot Appeal Processing" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Promobot Appeal Processing
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API reference
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/digital-fracture/promobot-appeal-processing" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    digital-fracture/promobot-appeal-processing
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Promobot Appeal Processing" class="md-nav__button md-logo" aria-label="Promobot Appeal Processing" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Promobot Appeal Processing
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/digital-fracture/promobot-appeal-processing" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    digital-fracture/promobot-appeal-processing
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API reference
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API reference
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core" class="md-nav__link">
    <span class="md-ellipsis">
      Core
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.predict_async" class="md-nav__link">
    <span class="md-ellipsis">
      predict_async
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.predict_many" class="md-nav__link">
    <span class="md-ellipsis">
      predict_many
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.Prediction" class="md-nav__link">
    <span class="md-ellipsis">
      Prediction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prediction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.Prediction.topic" class="md-nav__link">
    <span class="md-ellipsis">
      topic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.Prediction.topic_group" class="md-nav__link">
    <span class="md-ellipsis">
      topic_group
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.Prediction.executor" class="md-nav__link">
    <span class="md-ellipsis">
      executor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.Prediction.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geography-submodule" class="md-nav__link">
    <span class="md-ellipsis">
      Geography submodule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Geography submodule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.geography.predict_geography" class="md-nav__link">
    <span class="md-ellipsis">
      predict_geography
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.geography.predict_geography_async" class="md-nav__link">
    <span class="md-ellipsis">
      predict_geography_async
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.geography.predict_geography_many" class="md-nav__link">
    <span class="md-ellipsis">
      predict_geography_many
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core" class="md-nav__link">
    <span class="md-ellipsis">
      Core
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.predict_async" class="md-nav__link">
    <span class="md-ellipsis">
      predict_async
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.predict_many" class="md-nav__link">
    <span class="md-ellipsis">
      predict_many
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.Prediction" class="md-nav__link">
    <span class="md-ellipsis">
      Prediction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prediction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.Prediction.topic" class="md-nav__link">
    <span class="md-ellipsis">
      topic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.Prediction.topic_group" class="md-nav__link">
    <span class="md-ellipsis">
      topic_group
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.Prediction.executor" class="md-nav__link">
    <span class="md-ellipsis">
      executor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.Prediction.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geography-submodule" class="md-nav__link">
    <span class="md-ellipsis">
      Geography submodule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Geography submodule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.geography.predict_geography" class="md-nav__link">
    <span class="md-ellipsis">
      predict_geography
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.geography.predict_geography_async" class="md-nav__link">
    <span class="md-ellipsis">
      predict_geography_async
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promobot_appeal_processing.geography.predict_geography_many" class="md-nav__link">
    <span class="md-ellipsis">
      predict_geography_many
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="api-reference">API reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<h2 id="core">Core<a class="headerlink" href="#core" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-function">


<h3 id="promobot_appeal_processing.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Prediction</span></code>

<a href="#promobot_appeal_processing.predict" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

      <p>Synchronously predict appeal classification</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>text</code></b>
              (<code>str</code>)
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>text</code></b>
              (<code>str</code>)
          –
          <div class="doc-md-description">
            <p>Appeal text</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="promobot_appeal_processing.structures.Prediction" href="#promobot_appeal_processing.Prediction">Prediction</a></code>
          –
          <div class="doc-md-description">
            <p>Predicted classification</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/promobot_appeal_processing/main.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-9"><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Prediction</span><span class="p">:</span>
</span><span id="__span-0-10"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-11"><span class="sd">    Synchronously predict appeal classification</span>
</span><span id="__span-0-12">
</span><span id="__span-0-13"><span class="sd">    Args:</span>
</span><span id="__span-0-14"><span class="sd">        text: Appeal text</span>
</span><span id="__span-0-15">
</span><span id="__span-0-16"><span class="sd">    Returns:</span>
</span><span id="__span-0-17"><span class="sd">        Predicted classification</span>
</span><span id="__span-0-18"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-19">    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">text</span><span class="p">])</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="promobot_appeal_processing.predict_async" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict_async</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Prediction</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#promobot_appeal_processing.predict_async" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

      <p>Asynchronous wrapper around the <code>predict</code> function</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>text</code></b>
              (<code>str</code>)
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-py highlight"><pre><span></span><code><span id="__span-0-1"><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">Body</span>
</span><span id="__span-0-2"><span class="kn">from</span> <span class="nn">promobot_appeal_processing</span> <span class="kn">import</span> <span class="n">predict_async</span>
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
</span><span id="__span-0-5">
</span><span id="__span-0-6"><span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/api&quot;</span><span class="p">)</span>
</span><span id="__span-0-7"><span class="k">async</span> <span class="k">def</span> <span class="nf">api</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Body</span><span class="p">(</span><span class="n">embed</span><span class="o">=</span><span class="kc">True</span><span class="p">)):</span>
</span><span id="__span-0-8"><span class="hll">    <span class="k">return</span> <span class="k">await</span> <span class="n">predict_async</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span></span></code></pre></div>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>text</code></b>
              (<code>str</code>)
          –
          <div class="doc-md-description">
            <p>Appeal text</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="promobot_appeal_processing.structures.Prediction" href="#promobot_appeal_processing.Prediction">Prediction</a></code>
          –
          <div class="doc-md-description">
            <p>Predicted classification</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/promobot_appeal_processing/main.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-22"><span class="k">async</span> <span class="k">def</span> <span class="nf">predict_async</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Prediction</span><span class="p">:</span>
</span><span id="__span-0-23"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-24"><span class="sd">    Asynchronous wrapper around the ``predict`` function</span>
</span><span id="__span-0-25">
</span><span id="__span-0-26"><span class="sd">    Example:</span>
</span><span id="__span-0-27"><span class="sd">        ```py hl_lines=&quot;8&quot;</span>
</span><span id="__span-0-28"><span class="sd">        from fastapi import FastAPI, Body</span>
</span><span id="__span-0-29"><span class="sd">        from promobot_appeal_processing import predict_async</span>
</span><span id="__span-0-30">
</span><span id="__span-0-31"><span class="sd">        app = FastAPI()</span>
</span><span id="__span-0-32">
</span><span id="__span-0-33"><span class="sd">        @app.post(&quot;/api&quot;)</span>
</span><span id="__span-0-34"><span class="sd">        async def api(text: str = Body(embed=True)):</span>
</span><span id="__span-0-35"><span class="sd">            return await predict_async(text)</span>
</span><span id="__span-0-36"><span class="sd">        ```</span>
</span><span id="__span-0-37">
</span><span id="__span-0-38"><span class="sd">    Args:</span>
</span><span id="__span-0-39"><span class="sd">        text: Appeal text</span>
</span><span id="__span-0-40">
</span><span id="__span-0-41"><span class="sd">    Returns:</span>
</span><span id="__span-0-42"><span class="sd">        Predicted classification</span>
</span><span id="__span-0-43"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-44">    <span class="k">return</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">to_thread</span><span class="p">(</span><span class="n">predict</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="promobot_appeal_processing.predict_many" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict_many</span><span class="p">(</span><span class="n">texts</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Prediction</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#promobot_appeal_processing.predict_many" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

      <p>Wrapper around the <code>predict</code> function that executes the prediction tasks in parallel
using <code>max_workers</code> processes</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>texts</code></b>
              (<code><span title="typing.Iterable">Iterable</span>[str]</code>)
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>max_workers</code></b>
              (<code>int</code>)
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-py highlight"><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span> <span class="nn">aiofiles</span>
</span><span id="__span-0-2"><span class="kn">import</span> <span class="nn">aiocsv</span>
</span><span id="__span-0-3"><span class="kn">import</span> <span class="nn">csv</span>
</span><span id="__span-0-4"><span class="kn">import</span> <span class="nn">io</span>
</span><span id="__span-0-5"><span class="kn">from</span> <span class="nn">charset_normalizer</span> <span class="kn">import</span> <span class="n">from_bytes</span>
</span><span id="__span-0-6"><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">asdict</span><span class="p">,</span> <span class="n">fields</span>
</span><span id="__span-0-7"><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">UploadFile</span>
</span><span id="__span-0-8"><span class="kn">from</span> <span class="nn">fastapi.responses</span> <span class="kn">import</span> <span class="n">FileResponse</span>
</span><span id="__span-0-9"><span class="kn">from</span> <span class="nn">promobot_appeal_processing</span> <span class="kn">import</span> <span class="n">predict_many</span><span class="p">,</span> <span class="n">Prediction</span>
</span><span id="__span-0-10">
</span><span id="__span-0-11"><span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
</span><span id="__span-0-12">
</span><span id="__span-0-13"><span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/file&quot;</span><span class="p">)</span>
</span><span id="__span-0-14"><span class="k">async</span> <span class="k">def</span> <span class="nf">file</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n">UploadFile</span><span class="p">):</span>
</span><span id="__span-0-15">    <span class="n">contents</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">from_bytes</span><span class="p">(</span><span class="k">await</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">best</span><span class="p">())</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="c1"># (1)!</span>
</span><span id="__span-0-16">    <span class="n">csv_reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">contents</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span> <span class="c1"># (2)!</span>
</span><span id="__span-0-17">    <span class="n">rows</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">csv_reader</span><span class="p">)</span>
</span><span id="__span-0-18">    <span class="n">texts</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span> <span class="n">rows</span><span class="p">)</span>
</span><span id="__span-0-19">
</span><span id="__span-0-20">    <span class="n">data</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span>
</span><span id="__span-0-21">        <span class="k">lambda</span> <span class="n">row</span><span class="p">,</span> <span class="n">prediction</span><span class="p">:</span> <span class="n">row</span> <span class="o">|</span> <span class="n">asdict</span><span class="p">(</span><span class="n">prediction</span><span class="p">),</span>
</span><span id="__span-0-22">        <span class="n">rows</span><span class="p">,</span>
</span><span id="__span-0-23"><span class="hll">        <span class="k">await</span> <span class="n">predict_many</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">max_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</span></span><span id="__span-0-24">    <span class="p">)</span>
</span><span id="__span-0-25">
</span><span id="__span-0-26">    <span class="k">async</span> <span class="k">with</span> <span class="n">aiofiles</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span> <span class="o">:=</span> <span class="s2">&quot;temp.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out_file</span><span class="p">:</span>
</span><span id="__span-0-27">        <span class="n">csv_writer</span> <span class="o">=</span> <span class="n">aiocsv</span><span class="o">.</span><span class="n">AsyncDictWriter</span><span class="p">(</span>
</span><span id="__span-0-28">            <span class="n">out_file</span><span class="p">,</span>
</span><span id="__span-0-29">            <span class="n">fieldnames</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-30">                <span class="o">*</span><span class="n">csv_reader</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">,</span>
</span><span id="__span-0-31">                <span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">field</span><span class="p">:</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">fields</span><span class="p">(</span><span class="n">Prediction</span><span class="p">))</span> <span class="c1"># (3)!</span>
</span><span id="__span-0-32">            <span class="p">]</span>
</span><span id="__span-0-33">        <span class="p">)</span>
</span><span id="__span-0-34">        <span class="k">await</span> <span class="n">csv_writer</span><span class="o">.</span><span class="n">writeheader</span><span class="p">()</span>
</span><span id="__span-0-35">
</span><span id="__span-0-36">        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span><span id="__span-0-37">            <span class="k">await</span> <span class="n">csv_writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span id="__span-0-38">
</span><span id="__span-0-39">    <span class="k">return</span> <span class="n">FileResponse</span><span class="p">(</span>
</span><span id="__span-0-40">        <span class="n">path</span><span class="p">,</span>
</span><span id="__span-0-41">        <span class="n">media_type</span><span class="o">=</span><span class="s2">&quot;text/csv&quot;</span><span class="p">,</span>
</span><span id="__span-0-42">        <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;predictions.csv&quot;</span>
</span><span id="__span-0-43">    <span class="p">)</span>
</span></code></pre></div>
<ol>
<li>Trying to properly decode binary <code>UploadFile</code></li>
<li>European versions of <span class="twemoji excel"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23 1.5q.41 0 .7.3.3.29.3.7v19q0 .41-.3.7-.29.3-.7.3H7q-.41 0-.7-.3-.3-.29-.3-.7V18H1q-.41 0-.7-.3-.3-.29-.3-.7V7q0-.41.3-.7Q.58 6 1 6h5V2.5q0-.41.3-.7.29-.3.7-.3zM6 13.28l1.42 2.66h2.14l-2.38-3.87 2.34-3.8H7.46l-1.3 2.4-.05.08-.04.09-.64-1.28-.66-1.29H2.59l2.27 3.82-2.48 3.85h2.16zM14.25 21v-3H7.5v3zm0-4.5v-3.75H12v3.75zm0-5.25V7.5H12v3.75zm0-5.25V3H7.5v3zm8.25 15v-3h-6.75v3zm0-4.5v-3.75h-6.75v3.75zm0-5.25V7.5h-6.75v3.75zm0-5.25V3h-6.75v3Z"/></svg></span> <strong>Microsoft Excel</strong> export <code>.csv</code> files
    with <strong>semicolon</strong> delimiter by default. If your <code>.csv</code> file has <strong>comma</strong> as a delimiter
    you can remove this parameter (<strong>comma</strong> is the default parameter value).</li>
<li>Adding predicted columns to the output <code>.csv</code> file</li>
</ol>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>texts</code></b>
              (<code><span title="typing.Iterable">Iterable</span>[str]</code>)
          –
          <div class="doc-md-description">
            <p>Appeal texts</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>max_workers</code></b>
              (<code>int</code>)
          –
          <div class="doc-md-description">
            <p>Maximum number of parallel processes (passed to <code>asyncio.ProcessPoolExecutor</code>)</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code>tuple[<a class="autorefs autorefs-internal" title="promobot_appeal_processing.structures.Prediction" href="#promobot_appeal_processing.Prediction">Prediction</a>]</code>
          –
          <div class="doc-md-description">
            <p>Predicted classifications for all appeal texts (in respective order)</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/promobot_appeal_processing/main.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-47"><span class="k">async</span> <span class="k">def</span> <span class="nf">predict_many</span><span class="p">(</span><span class="n">texts</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Prediction</span><span class="p">]:</span>
</span><span id="__span-0-48"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-49"><span class="sd">    Wrapper around the ``predict`` function that executes the prediction tasks in parallel</span>
</span><span id="__span-0-50"><span class="sd">    using ``max_workers`` processes</span>
</span><span id="__span-0-51">
</span><span id="__span-0-52"><span class="sd">    Example:</span>
</span><span id="__span-0-53"><span class="sd">        ```py hl_lines=&quot;23&quot;</span>
</span><span id="__span-0-54"><span class="sd">        import aiofiles</span>
</span><span id="__span-0-55"><span class="sd">        import aiocsv</span>
</span><span id="__span-0-56"><span class="sd">        import csv</span>
</span><span id="__span-0-57"><span class="sd">        import io</span>
</span><span id="__span-0-58"><span class="sd">        from charset_normalizer import from_bytes</span>
</span><span id="__span-0-59"><span class="sd">        from dataclasses import asdict, fields</span>
</span><span id="__span-0-60"><span class="sd">        from fastapi import FastAPI, UploadFile</span>
</span><span id="__span-0-61"><span class="sd">        from fastapi.responses import FileResponse</span>
</span><span id="__span-0-62"><span class="sd">        from promobot_appeal_processing import predict_many, Prediction</span>
</span><span id="__span-0-63">
</span><span id="__span-0-64"><span class="sd">        app = FastAPI()</span>
</span><span id="__span-0-65">
</span><span id="__span-0-66"><span class="sd">        @app.post(&quot;/file&quot;)</span>
</span><span id="__span-0-67"><span class="sd">        async def file(file: UploadFile):</span>
</span><span id="__span-0-68"><span class="sd">            contents = str(from_bytes(await file.read()).best()).strip() # (1)!</span>
</span><span id="__span-0-69"><span class="sd">            csv_reader = csv.DictReader(io.StringIO(contents), delimiter=&quot;;&quot;) # (2)!</span>
</span><span id="__span-0-70"><span class="sd">            rows = tuple(csv_reader)</span>
</span><span id="__span-0-71"><span class="sd">            texts = map(lambda row: row[&quot;text&quot;], rows)</span>
</span><span id="__span-0-72">
</span><span id="__span-0-73"><span class="sd">            data = map(</span>
</span><span id="__span-0-74"><span class="sd">                lambda row, prediction: row | asdict(prediction),</span>
</span><span id="__span-0-75"><span class="sd">                rows,</span>
</span><span id="__span-0-76"><span class="sd">                await predict_many(texts, max_workers=4)</span>
</span><span id="__span-0-77"><span class="sd">            )</span>
</span><span id="__span-0-78">
</span><span id="__span-0-79"><span class="sd">            async with aiofiles.open(path := &quot;temp.csv&quot;, &quot;w&quot;, encoding=&quot;utf-8&quot;) as out_file:</span>
</span><span id="__span-0-80"><span class="sd">                csv_writer = aiocsv.AsyncDictWriter(</span>
</span><span id="__span-0-81"><span class="sd">                    out_file,</span>
</span><span id="__span-0-82"><span class="sd">                    fieldnames=[</span>
</span><span id="__span-0-83"><span class="sd">                        *csv_reader.fieldnames,</span>
</span><span id="__span-0-84"><span class="sd">                        *map(lambda field: field.name, fields(Prediction)) # (3)!</span>
</span><span id="__span-0-85"><span class="sd">                    ]</span>
</span><span id="__span-0-86"><span class="sd">                )</span>
</span><span id="__span-0-87"><span class="sd">                await csv_writer.writeheader()</span>
</span><span id="__span-0-88">
</span><span id="__span-0-89"><span class="sd">                for row in data:</span>
</span><span id="__span-0-90"><span class="sd">                    await csv_writer.writerow(row)</span>
</span><span id="__span-0-91">
</span><span id="__span-0-92"><span class="sd">            return FileResponse(</span>
</span><span id="__span-0-93"><span class="sd">                path,</span>
</span><span id="__span-0-94"><span class="sd">                media_type=&quot;text/csv&quot;,</span>
</span><span id="__span-0-95"><span class="sd">                filename=&quot;predictions.csv&quot;</span>
</span><span id="__span-0-96"><span class="sd">            )</span>
</span><span id="__span-0-97"><span class="sd">        ```</span>
</span><span id="__span-0-98">
</span><span id="__span-0-99"><span class="sd">        1.  Trying to properly decode binary ``UploadFile``</span>
</span><span id="__span-0-100"><span class="sd">        2.  European versions of :simple-microsoftexcel:{ .excel } **Microsoft Excel** export ``.csv`` files</span>
</span><span id="__span-0-101"><span class="sd">            with **semicolon** delimiter by default. If your ``.csv`` file has **comma** as a delimiter</span>
</span><span id="__span-0-102"><span class="sd">            you can remove this parameter (**comma** is the default parameter value).</span>
</span><span id="__span-0-103"><span class="sd">        3.  Adding predicted columns to the output ``.csv`` file</span>
</span><span id="__span-0-104">
</span><span id="__span-0-105"><span class="sd">    Args:</span>
</span><span id="__span-0-106"><span class="sd">        texts: Appeal texts</span>
</span><span id="__span-0-107"><span class="sd">        max_workers: Maximum number of parallel processes (passed to ``asyncio.ProcessPoolExecutor``)</span>
</span><span id="__span-0-108">
</span><span id="__span-0-109"><span class="sd">    Returns:</span>
</span><span id="__span-0-110"><span class="sd">        Predicted classifications for all appeal texts (in respective order)</span>
</span><span id="__span-0-111"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-112">    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span>
</span><span id="__span-0-113">    <span class="n">executor</span> <span class="o">=</span> <span class="n">ProcessPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span><span class="p">)</span>
</span><span id="__span-0-114">
</span><span id="__span-0-115">    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="__span-0-116">        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
</span><span id="__span-0-117">            <span class="o">*</span><span class="p">(</span><span class="n">loop</span><span class="o">.</span><span class="n">run_in_executor</span><span class="p">(</span><span class="n">executor</span><span class="p">,</span> <span class="n">predict</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">)</span>
</span><span id="__span-0-118">        <span class="p">)</span>
</span><span id="__span-0-119">    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="promobot_appeal_processing.Prediction" class="doc doc-heading">
            <code>Prediction</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#promobot_appeal_processing.Prediction" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


              <details class="quote">
                <summary>Source code in <code>src/promobot_appeal_processing/structures.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-4"><span class="nd">@dataclass</span>
</span><span id="__span-0-5"><span class="k">class</span> <span class="nc">Prediction</span><span class="p">:</span>
</span><span id="__span-0-6">    <span class="n">topic</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-0-7">    <span class="n">topic_group</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-0-8">    <span class="n">executor</span><span class="p">:</span> <span class="nb">str</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="promobot_appeal_processing.Prediction.topic" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">topic</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#promobot_appeal_processing.Prediction.topic" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="promobot_appeal_processing.Prediction.topic_group" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">topic_group</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#promobot_appeal_processing.Prediction.topic_group" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="promobot_appeal_processing.Prediction.executor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">executor</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#promobot_appeal_processing.Prediction.executor" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="promobot_appeal_processing.Prediction.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">topic_group</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">executor</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

<a href="#promobot_appeal_processing.Prediction.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>



  </div>

    </div>

</div><h2 id="geography-submodule">Geography submodule<a class="headerlink" href="#geography-submodule" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-function">


<h3 id="promobot_appeal_processing.geography.predict_geography" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict_geography</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

<a href="#promobot_appeal_processing.geography.predict_geography" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

      <p>Extract geographical object names from the given <code>text</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>text</code></b>
              (<code>str</code>)
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>text</code></b>
              (<code>str</code>)
          –
          <div class="doc-md-description">
            <p>Appeal text</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code>tuple[str]</code>
          –
          <div class="doc-md-description">
            <p>Geographical names</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/promobot_appeal_processing/geography/main.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-11"><span class="k">def</span> <span class="nf">predict_geography</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-0-12"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-13"><span class="sd">    Extract geographical object names from the given ``text``</span>
</span><span id="__span-0-14">
</span><span id="__span-0-15"><span class="sd">    Args:</span>
</span><span id="__span-0-16"><span class="sd">        text: Appeal text</span>
</span><span id="__span-0-17">
</span><span id="__span-0-18"><span class="sd">    Returns:</span>
</span><span id="__span-0-19"><span class="sd">        Geographical names</span>
</span><span id="__span-0-20"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-21">    <span class="k">return</span> <span class="n">geography</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="promobot_appeal_processing.geography.predict_geography_async" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict_geography_async</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#promobot_appeal_processing.geography.predict_geography_async" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

      <p>Asynchronous wrapper around the <code>predict_geography</code> function</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>text</code></b>
              (<code>str</code>)
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>text</code></b>
              (<code>str</code>)
          –
          <div class="doc-md-description">
            <p>Appeal text</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code>tuple[str]</code>
          –
          <div class="doc-md-description">
            <p>Geographical names</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/promobot_appeal_processing/geography/main.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-24"><span class="k">async</span> <span class="k">def</span> <span class="nf">predict_geography_async</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-0-25"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-26"><span class="sd">    Asynchronous wrapper around the ``predict_geography`` function</span>
</span><span id="__span-0-27">
</span><span id="__span-0-28"><span class="sd">    Args:</span>
</span><span id="__span-0-29"><span class="sd">        text: Appeal text</span>
</span><span id="__span-0-30">
</span><span id="__span-0-31"><span class="sd">    Returns:</span>
</span><span id="__span-0-32"><span class="sd">        Geographical names</span>
</span><span id="__span-0-33"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-34">    <span class="k">return</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">to_thread</span><span class="p">(</span><span class="n">predict_geography</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="promobot_appeal_processing.geography.predict_geography_many" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict_geography_many</span><span class="p">(</span><span class="n">texts</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#promobot_appeal_processing.geography.predict_geography_many" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

      <p>Wrapper around the <code>predict_geography</code> function that executes the geography name extraction tasks
in parallel using <code>max_workers</code> processes</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>texts</code></b>
              (<code><span title="typing.Iterable">Iterable</span>[str]</code>)
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>max_workers</code></b>
              (<code>int</code>)
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code>texts</code></b>
              (<code><span title="typing.Iterable">Iterable</span>[str]</code>)
          –
          <div class="doc-md-description">
            <p>Appeal texts</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code>max_workers</code></b>
              (<code>int</code>)
          –
          <div class="doc-md-description">
            <p>Maximum number of parallel processes (passed to <code>asyncio.ProcessPoolExecutor</code>)</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code>tuple[tuple[str]]</code>
          –
          <div class="doc-md-description">
            <p>Geographical names from all appeal texts (in respective order)</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>src/promobot_appeal_processing/geography/main.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-37"><span class="k">async</span> <span class="k">def</span> <span class="nf">predict_geography_many</span><span class="p">(</span><span class="n">texts</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="__span-0-38"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-39"><span class="sd">    Wrapper around the ``predict_geography`` function that executes the geography name extraction tasks</span>
</span><span id="__span-0-40"><span class="sd">    in parallel using ``max_workers`` processes</span>
</span><span id="__span-0-41">
</span><span id="__span-0-42"><span class="sd">    Args:</span>
</span><span id="__span-0-43"><span class="sd">        texts: Appeal texts</span>
</span><span id="__span-0-44"><span class="sd">        max_workers: Maximum number of parallel processes (passed to ``asyncio.ProcessPoolExecutor``)</span>
</span><span id="__span-0-45">
</span><span id="__span-0-46"><span class="sd">    Returns:</span>
</span><span id="__span-0-47"><span class="sd">        Geographical names from all appeal texts (in respective order)</span>
</span><span id="__span-0-48"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-49">    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span>
</span><span id="__span-0-50">    <span class="n">executor</span> <span class="o">=</span> <span class="n">ProcessPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span><span class="p">)</span>
</span><span id="__span-0-51">
</span><span id="__span-0-52">    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="__span-0-53">        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
</span><span id="__span-0-54">            <span class="o">*</span><span class="p">(</span><span class="n">loop</span><span class="o">.</span><span class="n">run_in_executor</span><span class="p">(</span><span class="n">executor</span><span class="p">,</span> <span class="n">predict_geography</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">)</span>
</span><span id="__span-0-55">        <span class="p">)</span>
</span><span id="__span-0-56">    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 digital-fracture
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.annotate"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.081f42fc.min.js"></script>
      
    
  </body>
</html>